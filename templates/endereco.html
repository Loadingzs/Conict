{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header text-center py-4" style="background: linear-gradient(135deg, var(--primary), #1e4a8a);">
                <h3 class="text-white mb-0">
                    <i class="fas fa-map-marker-alt me-2"></i>Endereço de Entrega
                </h3>
                <p class="text-light mb-0 mt-2">Para onde devemos enviar seu pedido?</p>
            </div>
            
            <div class="card-body p-5">
                <form method="POST" action="{{ url_for('salvar_endereco_pagamento') }}">
                    <input type="hidden" name="pedido_id" value="{{ pedido_id }}">
                    
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label for="cep" class="form-label fw-semibold">CEP *</label>
                            <input type="text" class="form-control" id="cep" name="cep" 
                                   placeholder="00000-000" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="logradouro" class="form-label fw-semibold">Logradouro *</label>
                            <input type="text" class="form-control" id="logradouro" name="logradouro" 
                                   placeholder="Rua, Avenida, etc." required>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="numero" class="form-label fw-semibold">Número *</label>
                            <input type="text" class="form-control" id="numero" name="numero" 
                                   placeholder="123" required>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="complemento" class="form-label fw-semibold">Complemento</label>
                            <input type="text" class="form-control" id="complemento" name="complemento" 
                                   placeholder="Apartamento, bloco, etc.">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="bairro" class="form-label fw-semibold">Bairro *</label>
                            <input type="text" class="form-control" id="bairro" name="bairro" 
                                   placeholder="Seu bairro" required>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="cidade" class="form-label fw-semibold">Cidade *</label>
                            <input type="text" class="form-control" id="cidade" name="cidade" 
                                   placeholder="Sua cidade" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="estado" class="form-label fw-semibold">Estado *</label>
                            <select class="form-control" id="estado" name="estado" required>
                                <option value="">Selecione seu estado</option>
                                <option value="SP">São Paulo</option>
                                <option value="RJ">Rio de Janeiro</option>
                                <option value="MG">Minas Gerais</option>
                                <option value="ES">Espírito Santo</option>
                                <option value="PR">Paraná</option>
                                <option value="SC">Santa Catarina</option>
                                <option value="RS">Rio Grande do Sul</option>
                                <!-- Adicione outros estados -->
                            </select>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-lg w-100 py-3 fw-bold">
                        <i class="fas fa-truck me-2"></i>Salvar Endereço e Continuar
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
// Buscar CEP automaticamente
document.getElementById('cep').addEventListener('blur', function() {
    const cep = this.value.replace(/\D/g, '');
    
    if (cep.length === 8) {
        fetch(`https://viacep.com.br/ws/${cep}/json/`)
            .then(response => response.json())
            .then(data => {
                if (!data.erro) {
                    document.getElementById('logradouro').value = data.logradouro || '';
                    document.getElementById('bairro').value = data.bairro || '';
                    document.getElementById('cidade').value = data.localidade || '';
                    document.getElementById('estado').value = data.uf || '';
                }
            });
    }
});
</script>
{% endblock %}